---
description: 仕様駆動開発（SDD）のワークフロー。requirements.md → design.md → tasks.md の流れでプロジェクトを進める
---

# /sdd ワークフロー（仕様駆動開発）

## 概要
仕様駆動開発（Specification-Driven Development）は、以下の3つのドキュメントを軸にプロジェクトを進める手法です：

1. **requirements.md** - 要件定義（何を作るか / Why）
2. **design.md** - 設計書（どう作るか / How）
3. **tasks.md** - タスク管理（進捗管理）

### SDDの核心思想
- **仕様がSSoT（唯一の正しい情報源）**: すべての実装は仕様に基づく
- **仕様は対話から生まれる**: 深掘り質問で隠れた要件を引き出す
- **仕様は実行可能**: AIが理解できる構造化されたフォーマット
- **仕様は検証可能**: テストコードで準拠性を確認
- **仕様はガードレール**: AIの暴走を防ぐ

参考:
- SDD基礎: https://zenn.dev/beagle/articles/fd60745bc54de1
- 対話的ヒアリング: https://zenn.dev/kenfdev/articles/ba5507f7532418

---

## ワークフロー

### Phase 1: プロジェクト初期化（/sdd init）
1. プロジェクトディレクトリを確認
2. 以下のファイルを作成：
   - `requirements.md` - 要件定義テンプレート
   - `design.md` - 設計書テンプレート
   - `tasks.md` - タスク管理テンプレート
   - `test-spec.md` - テスト仕様書テンプレート（新規追加）
3. ユーザーに「requirements.md を編集してプロジェクトの目的・要件を記入してください」と案内

### Phase 1.5: 対話的ヒアリング（/sdd interview）【新規追加】
初期仕様を深掘りし、隠れた要件・制約・前提を明確化するフェーズ：
1. `requirements.md` の初期版を読み込む（簡潔な仕様でも可）
2. 以下の観点から深掘り質問を生成：
   - **技術実装**: アーキテクチャ、技術スタック、パフォーマンス要件
   - **UI/UX**: ユーザー体験、アクセシビリティ、レスポンシブ対応
   - **懸念点**: セキュリティ、プライバシー、スケーラビリティ
   - **トレードオフ**: 開発速度 vs 品質、シンプルさ vs 機能性
   - **ビジネス**: 収益モデル、ターゲットユーザー、競合分析
3. 表面的・自明な質問は除外し、本質的な質問のみを抽出（15〜40個程度）
4. `notify_user` で質問リストをカテゴリ別に提示
5. ユーザーの回答を元に `requirements.md` を更新
6. 不明点が残っていれば追加質問を実施（継続的インタビュー）
7. すべての前提・要件・意思決定の背景が明確になったら Phase 2 へ

### Phase 2: 要件定義（/sdd req）
1. `requirements.md` を読み込む
2. ユーザーの入力を元に要件を整理・追記
3. 機能要件・非機能要件を明確化
4. **受け入れ基準（Acceptance Criteria）を明記**
5. 要件が確定したら「design.md の作成に進みますか？」と確認

### Phase 3: 設計（/sdd design）
1. `requirements.md` を参照
2. `design.md` を読み込む
3. 要件に基づいてアーキテクチャ・技術選定・構造を設計
4. **テスト戦略を定義（単体テスト/統合テスト/E2Eテストの範囲）**
5. 設計が確定したら「tasks.md のタスク分解に進みますか？」と確認

### Phase 4: タスク分解（/sdd tasks）
1. `requirements.md` と `design.md` を参照
2. `tasks.md` を読み込む
3. 設計を実装タスクに分解
4. **各タスクにテストタスクを含める**
5. 各タスクに優先度・依存関係を設定
6. 「最初に着手するタスクを選んでください」と案内

### Phase 5: 実装（/sdd impl）
1. `tasks.md` から次のタスクを取得
2. `design.md` を参照しながら実装
3. **実装と同時にテストコードも作成**
4. 実装完了後、`tasks.md` を更新
5. 「次のタスクに進みますか？」と確認

### Phase 6: 状態確認（/sdd status）
1. `requirements.md`, `design.md`, `tasks.md` を読み込む
2. 進捗サマリーを表示：
   - 要件の充足状況
   - 設計の完成度
   - タスクの完了率
   - **テストカバレッジ状況**
3. 次のアクションを提案

### Phase 7: 仕様同期（/sdd sync）
コードを直接変更した場合に、仕様との同期を取るフェーズ：
1. 変更されたコードを確認
2. 影響を受ける仕様ドキュメントを特定
3. 仕様を更新し、変更理由を明記
4. テスト仕様も同期して更新

### Phase 8: 仕様レビュー（/sdd review）【新規追加】
外部で作成した仕様（スマホでメモしたアイデアなど）を評価するフェーズ：
1. `requirements.md` または入力テキストを読み込む
2. 以下の観点から妥当性を評価：
   - **技術的実現可能性**: 選定技術で実装可能か
   - **スコープの明確さ**: 曖昧な要件がないか
   - **整合性**: 矛盾する要件がないか
   - **リスク**: セキュリティ、パフォーマンス、スケーラビリティ
   - **抜け漏れ**: 見落としている要件がないか
3. 評価結果を出力：
   - ✅ 良い点
   - ⚠️ 改善提案
   - ❓ 追加で確認が必要な点
4. 必要に応じて `requirements.md` を更新

### Phase 9: クイックスタート（/sdd kickstart）【新規追加】
interview → req → design を連続実行するショートカット：
1. `/sdd interview` を実行 → ユーザー確認
2. `/sdd req` を実行 → ユーザー確認
3. `/sdd design` を実行 → ユーザー確認
4. 全フェーズ完了後、`/plan` への移行を提案

> **Note**: 各フェーズ間でユーザー確認を挟むため、
> 完全自動ではなく「ガイド付き連続実行」となる

---

## コマンド一覧

| コマンド | 説明 |
|---------|------|
| `/sdd init` | プロジェクト初期化（テンプレート作成） |
| `/sdd interview` | 対話的ヒアリング（深掘り質問） |
| `/sdd req` | 要件定義の編集・確認 |
| `/sdd design` | 設計書の編集・確認 |
| `/sdd tasks` | タスク分解・更新 |
| `/sdd impl` | 次のタスクを実装 |
| `/sdd status` | 進捗状況の確認 |
| `/sdd sync` | 仕様とコードの同期確認 |
| `/sdd review` | **既存仕様の妥当性評価** |
| `/sdd kickstart` | **interview→req→designを連続実行** |

---

## ファイル構成

```
project/
├── docs/
│   ├── requirements.md   # 要件定義（SSoT）
│   ├── design.md         # 設計書
│   ├── tasks.md          # タスク管理
│   └── test-spec.md      # テスト仕様書
├── src/                  # ソースコード
└── tests/                # テストコード
```

---

## 双方向同期ルール

### 基本原則
- **仕様 → コード** が原則（コードは仕様を表現したもの）
- コードを直接変更した場合は、必ず仕様に反映

### コード直接変更時のフロー
1. 変更理由を記録（緊急バグ修正など）
2. `/sdd sync` を実行
3. 影響を受ける仕様を更新
4. テストを更新・実行

### 禁止事項
- 仕様を更新せずにコードだけ変更して放置する
- 仕様とコードの乖離を放置する

---

## テスト仕様の書き方

```markdown
## テストケース: [機能名]

### 正常系
| ID | 入力 | 期待結果 |
|----|------|----------|
| TC-001 | [入力] | [期待結果] |

### 異常系
| ID | 入力 | 期待結果 |
|----|------|----------|
| TC-002 | [不正な入力] | [エラーメッセージ] |

### 受け入れ基準
- [ ] [基準1]
- [ ] [基準2]
```

---

## 注意事項

- 各フェーズで前のドキュメントを必ず参照すること
- 要件変更があれば requirements.md を更新し、影響範囲を確認
- タスク完了時は必ず tasks.md を更新
- **仕様とコードの同期を常に維持すること**
- **テストは仕様の一部として扱うこと**

// turbo-all
